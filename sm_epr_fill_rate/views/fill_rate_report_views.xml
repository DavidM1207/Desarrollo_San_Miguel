<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista Tree (Lista) del Reporte Fill Rate -->
    <record id="view_fill_rate_report_tree" model="ir.ui.view">
        <field name="name">employee.purchase.requisition.fill.rate.report.tree</field>
        <field name="model">employee.purchase.requisition.fill.rate.report</field>
        <field name="arch" type="xml">
            <tree string="Reporte Fill Rate" create="false" edit="false" delete="false">
                <field name="date_created" string="Fecha Creación"/>
                <field name="requisition_number" string="Número Requisición"/>
                <field name="product_id" string="Producto"/>
                <field name="demand_type" string="Demanda"/>
                <field name="quantity_original" string="Cantidad Original (Unidades Solicitadas)" sum="Total Solicitado"/>
                <field name="quantity_delivered" string="Cantidad Demanda (Unidades Entregadas)" sum="Total Entregado"/>
                <field name="fill_rate" string="Fill Rate (%)" 
                       decoration-success="fill_rate >= 100"
                       decoration-warning="fill_rate >= 80 and fill_rate &lt; 100"
                       decoration-danger="fill_rate &lt; 80"/>
            </tree>
        </field>
    </record>

    <!-- Vista Search (Filtros) del Reporte Fill Rate -->
    <record id="view_fill_rate_report_search" model="ir.ui.view">
        <field name="name">employee.purchase.requisition.fill.rate.report.search</field>
        <field name="model">employee.purchase.requisition.fill.rate.report</field>
        <field name="arch" type="xml">
            <search string="Buscar Reporte Fill Rate">
                <field name="requisition_number" string="Número Requisición"/>
                <field name="product_id" string="Producto"/>
                <field name="date_created" string="Fecha Creación"/>
                
                <filter string="Fill Rate Completo (100%)" name="filter_complete" 
                        domain="[('fill_rate', '=', 100)]"/>
                <filter string="Fill Rate Bueno (80-99%)" name="filter_good" 
                        domain="[('fill_rate', '&gt;=', 80), ('fill_rate', '&lt;', 100)]"/>
                <filter string="Fill Rate Bajo (&lt;80%)" name="filter_low" 
                        domain="[('fill_rate', '&lt;', 80)]"/>
                
                <separator/>
                <filter string="Este Mes" name="filter_this_month" 
                        domain="[('date_created', '&gt;=', (context_today() - relativedelta(day=1)).strftime('%Y-%m-%d')),
                                 ('date_created', '&lt;', (context_today() + relativedelta(day=31)).strftime('%Y-%m-%d'))]"/>
                <filter string="Este Año" name="filter_this_year" 
                        domain="[('date_created', '&gt;=', (context_today() - relativedelta(month=1, day=1)).strftime('%Y-%m-%d'))]"/>
                
                <separator/>
                <group expand="0" string="Agrupar Por">
                    <filter string="Producto" name="group_product" context="{'group_by': 'product_id'}"/>
                    <filter string="Requisición" name="group_requisition" context="{'group_by': 'requisition_number'}"/>
                    <filter string="Fecha Creación" name="group_date" context="{'group_by': 'date_created'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Acción de Ventana para el Reporte Fill Rate -->
    <record id="action_fill_rate_report" model="ir.actions.act_window">
        <field name="name">Reporte Fill Rate</field>
        <field name="res_model">employee.purchase.requisition.fill.rate.report</field>
        <field name="view_mode">tree</field>
        <field name="search_view_id" ref="view_fill_rate_report_search"/>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No hay datos para mostrar en el reporte Fill Rate
            </p>
            <p>
                Este reporte muestra el Fill Rate de las requisiciones de tipo Transferencia Interna.
            </p>
        </field>
    </record>

    <!-- Menú Principal: Reportes -->
    <!-- NOTA: Cambia 'parent' por el ID correcto de tu menú principal -->
    <menuitem id="menu_employee_purchase_requisition_reports"
              name="Reportes"
              parent="TU_MODULO.menu_principal"
              sequence="30"/>

    <!-- Submenú: Fill Rate -->
    <menuitem id="menu_fill_rate_report"
              name="Fill Rate"
              parent="menu_employee_purchase_requisition_reports"
              action="action_fill_rate_report"
              sequence="10"/>

</odoo>